<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Newsletter Welcome Email Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }

        .status-box {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }

        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }

        button {
            background: #4F46E5;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }

        button:hover {
            background: #3730A3;
        }

        .config-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>
</head>

<body>
    <h1>üéØ Newsletter Welcome Email Test - Resend + Firebase</h1>

    <div class="info status-box">
        <strong>üìß Welcome Email System Status</strong>
        <p>This page helps you test and configure automatic welcome emails using Resend + Firebase Functions.</p>
    </div>

    <div class="config-section">
        <h2>‚öôÔ∏è Configuration Status</h2>
        <div id="config-status">
            <p>Loading configuration...</p>
        </div>

        <h3>üîß Required Environment Variables</h3>
        <p>Add these to your <code>.env</code> file:</p>
        <pre style="background: #2d3748; color: #e2e8f0; padding: 15px; border-radius: 5px; overflow-x: auto;">
VITE_RESEND_API_KEY=your-resend-api-key-here
VITE_FIREBASE_FUNCTIONS_URL=https://your-region-your-project.cloudfunctions.net
VITE_SITE_NAME=Ruki Blog
VITE_SITE_URL=https://yoursite.com
VITE_SENDER_EMAIL=noreply@yoursite.com</pre>
    </div>

    <div class="config-section">
        <h2>üß™ Test Welcome Email</h2>
        <p>Enter an email address to test the welcome email functionality:</p>

        <form id="test-form">
            <input type="email" id="test-email" placeholder="test@example.com" required
                style="padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin-right: 10px; width: 250px;">
            <input type="text" id="test-name" placeholder="First Name (optional)"
                style="padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin-right: 10px; width: 150px;">
            <button type="submit">Send Test Email</button>
        </form>

        <div id="test-result" style="margin-top: 15px;"></div>
    </div>

    <div class="config-section">
        <h2>üìä Email Service Information</h2>
        <div id="service-info">
            <p>Loading service information...</p>
        </div>
    </div>

    <div class="config-section">
        <h2>üìù Setup Instructions</h2>
        <ol>
            <li><strong>Create Resend Account:</strong> Go to <a href="https://resend.com/"
                    target="_blank">resend.com</a></li>
            <li><strong>Get API Key:</strong> Create and copy your Resend API key</li>
            <li><strong>Set up Firebase:</strong> Initialize Firebase project with Functions</li>
            <li><strong>Deploy Functions:</strong> Deploy the email functions to Firebase</li>
            <li><strong>Update .env:</strong> Add the environment variables shown above</li>
            <li><strong>Restart Server:</strong> <code>npm run dev</code></li>
        </ol>

        <p><strong>üìñ Full Guide:</strong> See <code>RESEND_FIREBASE_SETUP.md</code> for detailed instructions.</p>
    </div>

    <script type="module">
        // Check if we're running in a Vite environment
        const isDev = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';

        if (!isDev) {
            document.body.innerHTML = `
                <div style="text-align: center; padding: 50px;">
                    <h1>‚ö†Ô∏è Development Only</h1>
                    <p>This test page is only available in development mode.</p>
                    <p>Run <code>npm run dev</code> to access this page.</p>
                </div>
            `;
        } else {
            // Display configuration status
            const configStatus = document.getElementById('config-status');
            const serviceInfo = document.getElementById('service-info');

            // Mock configuration check (in real app, this would use actual config)
            const envVars = {
                resendApiKey: import.meta.env.VITE_RESEND_API_KEY || '',
                functionsUrl: import.meta.env.VITE_FIREBASE_FUNCTIONS_URL || '',
                siteName: import.meta.env.VITE_SITE_NAME || 'Ruki Blog',
                siteUrl: import.meta.env.VITE_SITE_URL || 'https://yoursite.com',
                senderEmail: import.meta.env.VITE_SENDER_EMAIL || 'noreply@yoursite.com'
            };

            const isConfigured = envVars.functionsUrl && envVars.functionsUrl !== 'https://your-region-your-project.cloudfunctions.net';

            configStatus.innerHTML = `
                <div class="${isConfigured ? 'success' : 'warning'} status-box">
                    <strong>${isConfigured ? '‚úÖ Resend + Firebase Configured' : '‚ö†Ô∏è Resend + Firebase Not Configured'}</strong>
                    <p>${isConfigured ?
                    'Welcome emails will be sent automatically when users subscribe.' :
                    'Please configure Resend and Firebase Functions to enable welcome emails.'
                }</p>
                </div>
            `;

            serviceInfo.innerHTML = `
                <ul>
                    <li><strong>Functions URL:</strong> ${envVars.functionsUrl || 'Not configured'}</li>
                    <li><strong>Resend API Key:</strong> ${envVars.resendApiKey ? envVars.resendApiKey.substring(0, 8) + '...' : 'Not configured'}</li>
                    <li><strong>Site Name:</strong> ${envVars.siteName}</li>
                    <li><strong>Site URL:</strong> ${envVars.siteUrl}</li>
                    <li><strong>Sender Email:</strong> ${envVars.senderEmail}</li>
                </ul>
            `;

            // Handle test form
            document.getElementById('test-form').addEventListener('submit', function (e) {
                e.preventDefault();

                const email = document.getElementById('test-email').value;
                const name = document.getElementById('test-name').value;
                const result = document.getElementById('test-result');

                if (!isConfigured) {
                    result.innerHTML = `
                        <div class="error status-box">
                            <strong>‚ùå Cannot Send Test Email</strong>
                            <p>Resend + Firebase Functions are not configured. Please set up the required environment variables first.</p>
                        </div>
                    `;
                    return;
                }

                result.innerHTML = `
                    <div class="info status-box">
                        <strong>üìß Test Email Simulation</strong>
                        <p>In a real implementation, a welcome email would be sent via Firebase Functions to: <strong>${email}</strong></p>
                        <p>Recipient name: <strong>${name || 'Not provided'}</strong></p>
                        <p>Service: <strong>Resend + Firebase Functions</strong></p>
                        <p>Check your email inbox and the browser console for detailed logs.</p>
                    </div>
                `;

                console.log('Test welcome email would be sent via Firebase Functions:', {
                    email: email,
                    firstName: name,
                    functionsUrl: envVars.functionsUrl,
                    timestamp: new Date().toISOString()
                });
            });
        }
    </script>
</body>

</html>